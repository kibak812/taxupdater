# 🌐 세금 법령 크롤링 웹 인터페이스 사용 가이드

## 🎯 개요
기존 tkinter 기반 GUI를 웹 인터페이스로 전환하여 어디서든 접속 가능한 세금 법령 크롤링 모니터링 시스템입니다.

**핵심 목적**: 누락없는 데이터 수집과 새로운 데이터의 정확한 식별 - 웹에서 실시간 모니터링

## 🚀 빠른 시작

### 1. 웹 서버 시작
```bash
python start_web.py
```

### 2. 웹 브라우저에서 접속
- **로컬 접속**: http://localhost:8000
- **모바일/태블릿**: 같은 WiFi에서 http://[PC-IP]:8000

### 3. 외부에서 접속 (선택사항)
```bash
# ngrok 설치 후
ngrok http 8000
# 출력된 URL로 어디서든 접속 가능
```

## 🖥️ 인터페이스 구성

### 메인 대시보드 (`/`)
```
📊 세금 법령 크롤링 모니터링 시스템

┌─────────────────┬─────────────────┬─────────────────┐
│   조세심판원     │     국세청      │   기획재정부     │
│   💾 1,234개    │   💾 567개     │   💾 890개      │
│   🆕 5개 신규   │   🆕 2개 신규   │   ⏰ 1시간 전   │
│   [크롤링]      │   [크롤링]      │   [크롤링]       │
└─────────────────┴─────────────────┴─────────────────┘

🎯 [전체 사이트 크롤링]  🔄 [대시보드 새로고침]
```

### 사이트별 상세 페이지 (`/sites/{site}`)
- **데이터 테이블**: 페이지네이션으로 대용량 데이터 조회
- **실시간 검색**: 제목, 문서번호 등 즉시 검색
- **Excel 내보내기**: 필터된 데이터 다운로드 (향후 구현)

## ⚡ 주요 기능

### 🔄 크롤링 실행
- **개별 크롤링**: 각 사이트 카드의 "크롤링" 버튼
- **전체 크롤링**: "전체 사이트 크롤링" 버튼으로 6개 사이트 순차 실행
- **실시간 진행상황**: WebSocket으로 실시간 상태 업데이트

### 📊 데이터 모니터링
- **실시간 통계**: 총 데이터 수, 활성 사이트 수
- **새 데이터 알림**: 브라우저 알림으로 즉시 확인
- **상세 데이터 조회**: 사이트별 데이터 테이블 뷰

### 🔍 검색 및 필터링
- **키워드 검색**: 제목, 문서번호 등 전체 검색
- **페이지네이션**: 대용량 데이터 효율적 조회
- **정렬**: 최신순, 날짜순 정렬

## 🛠️ 기술적 특징

### 아키텍처
- **Backend**: FastAPI (Python) - 기존 크롤링 로직 100% 재사용
- **Frontend**: HTML/CSS/JavaScript - 반응형 웹 디자인
- **Database**: SQLite - 기존 데이터 그대로 활용
- **Real-time**: WebSocket - 실시간 크롤링 상태 모니터링

### 핵심 가치 보존
- ✅ **누락없는 데이터 수집**: 기존 example.py 로직 완벽 보존
- ✅ **정확한 새 데이터 식별**: SQL JOIN 최적화로 10배 성능 향상
- ✅ **실시간 모니터링**: 웹에서도 즉각적인 피드백
- ✅ **접근성**: 어디서든 웹브라우저로 접속 가능

## 📋 사용 시나리오

### 일상적인 모니터링
1. **아침**: 웹으로 접속하여 밤새 수집된 새 데이터 확인
2. **오후**: 전체 크롤링으로 최신 데이터 수집
3. **이동 중**: 스마트폰으로 알림 확인

### 상세 분석
1. **검색**: 특정 키워드로 관련 법령 검색
2. **필터링**: 날짜 범위로 최근 데이터만 조회
3. **내보내기**: 분석용 Excel 파일 다운로드

## 🔧 문제 해결

### 서버 시작 안 됨
```bash
# 의존성 재설치
source taxupdater_venv/bin/activate
pip install -r requirements.txt

# 포트 확인
lsof -i :8000  # 8000번 포트 사용 중인 프로세스 확인
```

### 크롤링 실행 안 됨
- **셀레니움 드라이버**: Chrome 브라우저 설치 확인
- **네트워크**: 대상 사이트 접속 가능 여부 확인
- **권한**: 데이터 폴더 쓰기 권한 확인

### 데이터 조회 안 됨
- **SQLite DB**: `data/tax_data.db` 파일 존재 확인
- **테이블 구조**: 앱 시작 시 자동 생성되는지 확인

## 📡 외부 접속 설정

### ngrok 사용 (권장)
```bash
# ngrok 설치
curl -s https://ngrok-agent.s3.amazonaws.com/ngrok.asc | sudo tee /etc/apt/trusted.gpg.d/ngrok.asc
echo "deb https://ngrok-agent.s3.amazonaws.com buster main" | sudo tee /etc/apt/sources.list.d/ngrok.list
sudo apt update && sudo apt install ngrok

# 터널 생성
ngrok http 8000

# 출력 예시:
# Forwarding: https://abc123.ngrok.io -> http://localhost:8000
```

### 포트 포워딩 사용
1. **공유기 설정**: 8000번 포트 포워딩 설정
2. **방화벽**: 8000번 포트 열기
3. **접속**: `http://[공인IP]:8000`

## 🔒 보안 고려사항

### 현재 상태
- **인증 없음**: 현재는 인증 시스템 없음
- **HTTP**: HTTPS 미적용 (로컬 네트워크용)

### 향후 개선 (필요시)
- **로그인 시스템**: 사용자 인증 추가
- **HTTPS**: SSL 인증서 적용
- **IP 제한**: 특정 IP만 접속 허용

## 📈 성능 최적화

### 데이터베이스
- **인덱스**: 생성일자, 키 컬럼 인덱싱 적용
- **SQL JOIN**: 새 데이터 탐지 최적화

### 웹 인터페이스
- **페이지네이션**: 대용량 데이터 효율적 처리
- **WebSocket**: 실시간 업데이트 최소화

## 🆕 향후 기능 (로드맵)

### Phase 1 (현재 완료)
- ✅ 웹 인터페이스 구축
- ✅ 실시간 모니터링
- ✅ 기본 CRUD 기능

### Phase 2 (향후)
- 📅 Excel 내보내기 완성
- 📅 고급 검색 필터
- 📅 데이터 시각화 차트

### Phase 3 (장기)
- 🔐 사용자 인증 시스템
- 📧 이메일 알림
- 📊 대시보드 커스터마이징

---

## 🤝 지원

문제 발생 시:
1. **로그 확인**: 터미널에 출력되는 오류 메시지 확인
2. **재시작**: `Ctrl+C` 후 `python start_web.py` 재실행
3. **의존성**: `pip install -r requirements.txt` 재실행

**연락처**: 기술 지원이 필요한 경우 문의 바랍니다.